!function(t,n){"use strict";"function"==typeof define&&define.amd?define(function(){return n()}):"object"==typeof exports&&module.exports?exports=module.exports=n():t.Then=n()}(this,function(){"use strict";function t(e,o,u,i){function c(t){return function(n){return f?void 0:(f=!0,t.call(void 0,n))}}var f=!1;if(e===o)throw new TypeError("donot resolve promise itself.");var s=r(o)&&o.then;if(n(s))try{s.call(o,c(function(n){try{t(o,n,u,i)}catch(e){c(i(e))}}),c(i))}catch(a){c(i)(a)}else u(o)}var n=function(t){return"function"==typeof t},e=function(t){return t&&"object"==typeof t},r=function(t){return e(t)||n(t)},o=Array.isArray||function(t){return"[object Array]"==={}.toString.call(t)},u=function(t){function e(t){if("pending"===o.status){o.value=t,o.status="fulfilled";for(var n=0,e=o.resolves.length;e>n;n++)o.resolves[n].call(void 0,t)}}function r(t){if("pending"===o.status){o.reason=t,o.status="rejected";for(var n=0,e=o.rejects.length;e>n;n++)o.rejects[n].call(void 0,t)}}if(!n(t))throw new TypeError("argument must be a function.");if(!(this instanceof u))return new u(t);var o=this;o.status="pending",o.resolves=[],o.rejects=[],t(e,r)};return u.reject=function(t){return new u(function(n,e){e(t)})},u.resolve=function(t){return new u(function(n){n(t)})},u.all=function(t){if(!o(t))throw new TypeError("argument must be a array.");return new u(function(n,e){function r(t){return function(e){o[t]=e,i++,i===u&&n(o)}}for(var o=[],u=t.length,i=0,c=0,f=t.length;f>c;c++)t[c].then(r(c),e)})},u.race=function(t){if(!o(t))throw new TypeError("argument must be a array.");return new u(function(n,e){for(var r=0,o=t.length;o>r;r++)t[r].then(n,e)})},u.prototype.then=function(e,r){var o=this,i=new u(function(u,c){function f(r){setTimeout(function(){if(n(e))try{var o=e(r);t(i,o,u,c)}catch(f){c(f)}else u(r)},0)}function s(e){setTimeout(function(){if(n(r))try{var o=r(e);t(i,o,u,c)}catch(f){c(f)}else c(e)},0)}"fulfilled"===o.status?f.call(void 0,o.value):"rejected"===o.status?s.call(void 0,o.reason):(o.resolves.push(f),o.rejects.push(s))});return i},u.prototype.catch=function(t){return this.then(void 0,t)},u});
